import subprocess

def check_null_session(ip):
    try:
        print(f"[+] Checking null session on {ip} ...")
        result = subprocess.getoutput(f"smbclient -L \\\\{ip} -N")
        if "Anonymous login successful" in result:
            print("[+] Null session enabled!")
        else:
            print("[-] Null session not allowed.")
    except Exception as e:
        print(f"[!] Error checking null session: {e}")
